<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Statistics">
	<resultMap id="StatisticsResult" type="Statistics">		
		<result property="memNo" column="memNo" />
		<result property="statisticsYear" column="statisticsYear" />
		<result property="statisticsInYearSum" column="statisticsInYearSum" />
		<result property="statisticsExYearSum" column="statisticsExYearSum" />			
	</resultMap>
			
	<select id="InStatisticsYear" parameterType="Statistics" resultMap="StatisticsResult" >		
		select distinct to_char(inDate,'YYYY') as "statisticsYear" from intable where memNo = #{memNo}
			order by to_char(inDate,'YYYY') desc
	</select>
	<select id="ExStatisticsYear" parameterType="Statistics" resultMap="StatisticsResult">		
		select distinct to_char(exDate,'YYYY') as "statisticsYear" from extable where memNo = #{memNo}
			order by to_char(exDate,'YYYY') desc
	</select>
	<!-- 
	<select id="StatisticsInYearSum" parameterType="Statistics" resultType="long">		
		select sum(inSum) from intable where memNo = #{memNo} 
			and inDate between #{statisticsYear}||'-01-01' and #{statisticsYear}||'-12-31'
	</select>
	<select id="StatisticsExYearSum" parameterType="Statistics" resultType="long">		
		select  sum(exSum) from extable where memNo = #{memNo} 
			and exDate between #{statisticsYear}||'-01-01' and #{statisticsYear}||'-12-31'
	</select>
	
	<select id="InStatisticsMonth" parameterType="Statistics" resultType="int">		
		select count(inDate) from intable where memNo = #{memNo} 
			and inDate between #{statisticsYear}||'-'||#{statisticsMonth}||'-01' 
				and #{statisticsYear}||'-'||#{statisticsMonth}||'-'||#{statisticsDay}
	</select>
	<select id="ExStatisticsMonth" parameterType="Statistics" resultType="int">		
		select count(exDate) from extable where memNo = #{memNo} 
			and exDate between #{statisticsYear}||'-'||#{statisticsMonth}||'-01' 
				and #{statisticsYear}||'-'||#{statisticsMonth}||'-'||#{statisticsDay}
	</select>
	
	<select id="InStatisticsMonthSum" parameterType="Statistics" resultType="long">		
		select sum(inSum) from intable where memNo = #{memNo} 
			and inDate between #{statisticsYear}||'-'||#{statisticsMonth}||'-01' 
				and #{statisticsYear}||'-'||#{statisticsMonth}||'-'||#{statisticsDay}
	</select>
	<select id="ExStatisticsMonthSum" parameterType="Statistics" resultType="long">		
		select sum(exSum) from extable where memNo = #{memNo} 
			and exDate between #{statisticsYear}||'-'||#{statisticsMonth}||'-01' 
				and #{statisticsYear}||'-'||#{statisticsMonth}||'-'||#{statisticsDay}
	</select>
	
	<select id="InStatisticsMonth" parameterType="Statistics" resultType="int">		
		select count(inDate) from intable where memNo = #{memNo} 
			and inDate between #{statisticsYear}||'-'||#{statisticsMonth}||'-01' 
				and #{statisticsYear}||'-'||#{statisticsMonth}||'-'||#{statisticsDay}
	</select>
	<select id="ExStatisticsMonth" parameterType="Statistics" resultType="int">		
		select count(exDate) from extable where memNo = #{memNo} 
			and exDate between #{statisticsYear}||'-'||#{statisticsMonth}||'-01' 
				and #{statisticsYear}||'-'||#{statisticsMonth}||'-'||#{statisticsDay}
	</select>
	
	<select id="InStatisticsMonthSum" parameterType="Statistics" resultType="long">		
		select sum(inSum) from intable where memNo = #{memNo} 
			and inDate between #{statisticsYear}||'-'||#{statisticsMonth}||'-01' 
				and #{statisticsYear}||'-'||#{statisticsMonth}||'-'||#{statisticsDay}
	</select>
	<select id="ExStatisticsMonthSum" parameterType="Statistics" resultType="long">		
		select sum(exSum) from extable where memNo = #{memNo} 
			and exDate between #{statisticsYear}||'-'||#{statisticsMonth}||'-01' 
				and #{statisticsYear}||'-'||#{statisticsMonth}||'-'||#{statisticsDay}
	</select>	 -->
</mapper>